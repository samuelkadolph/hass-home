- id: garage_off
  alias: Garage - Off
  mode: single
  triggers:
  - trigger: time
    at: sensor.garage_off_time
  actions:
  - action: script.garage_turn_off

- id: garage_door_garage_lights_switch_triple
  alias: Garage Door - Garage Lights Switch (Triple)
  use_blueprint:
    path: samuelkadolph/zooz_zen7677_covers.yaml
    input:
      covers: cover.garage_door
      switch: 4e1a97e407a9f5d6ee3717abbfafc4b8
      paddle_taps: KeyPressed3x
      state_variable: input_number.garage_door_control_state

- id: garage_door_lights_garage_door_opened
  alias: Garage Door Lights - Garage Door Opened
  mode: single
  max_exceeded: silent
  triggers:
  - trigger: state
    entity_id: binary_sensor.garage_door
    to: 'on'
  conditions:
  - '{{ is_state("light.garage_door_lights", "off") }}'
  actions:
  - action: light.turn_on
    target: { entity_id: light.garage_door_lights }
  - repeat:
      until:
      - condition: state
        entity_id:
        - binary_sensor.garage_door
        state: 'off'
        for: { seconds: 30 }
      - condition: state
        entity_id:
        - binary_sensor.garage_door_motion
        - binary_sensor.garage_door_obstruction
        state: 'off'
        for: { seconds: 120 }
      sequence:
      - delay: { seconds: 5 }
  - action: light.turn_off
    target: { entity_id: light.garage_door_lights }
