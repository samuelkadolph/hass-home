- id: garage_off
  alias: Garage - Off
  mode: single
  triggers:
  - trigger: time
    at: sensor.garage_off_time
  actions:
  - action: script.garage_turn_off

- id: garage_lights_triple_garage_door
  alias: Garage Lights (Triple) - Garage Door
  use_blueprint:
    path: samuelkadolph/zwave_switch_covers.yaml
    input:
      up_event: event.garage_lights_scene_001
      down_event: event.garage_lights_scene_002
      paddle_taps: KeyPressed3x
      covers: cover.garage_door
      state_variable: input_number.garage_door_control_state

- id: garage_door_lights_garage_door_opened
  alias: Garage Door Lights - Garage Door Opened
  mode: single
  max_exceeded: silent
  triggers:
  - trigger: state
    entity_id: binary_sensor.garage_door
    to: 'on'
  conditions:
  - '{{ is_state("light.garage_door_lights", "off") }}'
  actions:
  - action: light.turn_on
    target: { entity_id: light.garage_door_lights }
  - repeat:
      until:
      - condition: state
        entity_id:
        - binary_sensor.garage_door
        state: 'off'
        for: { seconds: 30 }
      - condition: state
        entity_id:
        - binary_sensor.garage_door_motion
        - binary_sensor.garage_door_obstruction
        state: 'off'
        for: { seconds: 120 }
      sequence:
      - delay: { seconds: 5 }
  - action: light.turn_off
    target: { entity_id: light.garage_door_lights }
